<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>GeneQuest Ultra - genepop</title>

<style>
body{
margin:0;
background:#0a192f;
color:white;
font-family:Arial;
text-align:center;
overflow:hidden;
}

canvas{
background:#102a43;
border:3px solid #00e5ff;
display:block;
margin:auto;
}

#top{
margin:6px;
font-weight:bold;
}

#owner{
position:fixed;
bottom:5px;
right:10px;
opacity:.4;
font-size:12px;
}

button{
padding:8px 14px;
border-radius:8px;
border:none;
cursor:pointer;
margin:4px;
}
</style>
</head>

<body>

<div id="top">
üß¨ GeneQuest Ultra | Player: <b>genepop</b><br>
‚≠ê Score: <span id="score">0</span> |
üèÜ High: <span id="high">0</span> |
‚ù§Ô∏è Lives: <span id="lives">3</span> |
‚è≥ Time: <span id="time">60</span>
</div>

<canvas id="game" width="650" height="420"></canvas>
<div id="panel"></div>

<div id="owner">¬© genepop</div>

<script>
/////////////////////
// HIGH SCORE SAVE
/////////////////////
let highScore = localStorage.getItem("genepop_high") || 0;
document.getElementById("high").innerText = highScore;

function saveHigh(score){
if(score>highScore){
highScore=score;
localStorage.setItem("genepop_high",score);
document.getElementById("high").innerText=score;
}
}

/////////////////////
// SOUND
/////////////////////
const ctx=new (window.AudioContext||window.webkitAudioContext)();
function beep(f,t){let o=ctx.createOscillator();let g=ctx.createGain();
o.connect(g);g.connect(ctx.destination);
o.frequency.value=f;o.start();g.gain.value=.2;o.stop(ctx.currentTime+t);}
const good=()=>beep(900,.1);
const bad=()=>beep(200,.2);

/////////////////////
// BASIC
/////////////////////
let canvas=document.getElementById("game");
let c=canvas.getContext("2d");
let panel=document.getElementById("panel");

let score=0,lives=3,time=60,level=1;

const scoreEl=document.getElementById("score");
const livesEl=document.getElementById("lives");
const timeEl=document.getElementById("time");

function ui(){
scoreEl.innerText=score;
livesEl.innerText=lives;
timeEl.innerText=time;
}

/////////////////////
// PLAYER (ÿπÿßŸÑŸêŸÖÿ©)
/////////////////////
let player={x:50,y:200,size:25,speed:4};

/////////////////////
// ENEMIES
/////////////////////
let enemies=[];

function spawn(){
enemies=[];
for(let i=0;i<level+1;i++){
enemies.push({x:Math.random()*600,y:Math.random()*380});
}
}

/////////////////////
// QUESTIONS BANK (100+)
/////////////////////
let questions=[];
for(let i=0;i<25;i++){
questions.push(
{q:"A pairs with ÿü",a:["T","G","C"],c:0},
{q:"aa is ÿü",a:["Recessive","Dominant","Mutation"],c:0},
{q:"CRISPR used forÿü",a:["DNA editing","Protein digestion","Energy"],c:0},
{q:"Which cell kills virusesÿü",a:["T cell","RBC","Neuron"],c:0}
);
}

function randomQuiz(){
let r=questions[Math.floor(Math.random()*questions.length)];
let html=`<h3>${r.q}</h3>`;
r.a.forEach((x,i)=>{
html+=`<button onclick="quiz(${i},${r.c})">${x}</button>`;
});
panel.innerHTML=html;
}

function quiz(i,corr){
if(i==corr){score+=10;good();}
else{lives--;bad();}
ui();
panel.innerHTML="";
}

/////////////////////
// DRAW
/////////////////////
function drawPlayer(x,y){
c.fillStyle="#ffd166";
c.beginPath(); c.arc(x+12,y+8,7,0,6.28); c.fill();
c.fillStyle="#06d6a0";
c.fillRect(x,y+14,24,18);
}

function drawVirus(x,y){
c.fillStyle="#ef476f";
c.beginPath(); c.arc(x,y,10,0,6.28); c.fill();
}

function draw(){
c.clearRect(0,0,650,420);

drawPlayer(player.x,player.y);

enemies.forEach(e=>drawVirus(e.x,e.y));
}

/////////////////////
// CONTROLS
/////////////////////
let keys={};
document.onkeydown=e=>keys[e.key]=true;
document.onkeyup=e=>keys[e.key]=false;

function move(){
if(keys["ArrowUp"])player.y-=player.speed;
if(keys["ArrowDown"])player.y+=player.speed;
if(keys["ArrowLeft"])player.x-=player.speed;
if(keys["ArrowRight"])player.x+=player.speed;
}

/////////////////////
// ENEMY AI
/////////////////////
function chase(){
enemies.forEach(e=>{
let dx=player.x-e.x;
let dy=player.y-e.y;
let d=Math.hypot(dx,dy);
e.x+=dx/d*(1+level*.4);
e.y+=dy/d*(1+level*.4);

if(Math.abs(dx)<14 && Math.abs(dy)<14){
lives--;bad();
player.x=50;player.y=200;
}
});
}

/////////////////////
// TIMER
/////////////////////
setInterval(()=>{
time--;
if(time<=0){
level++;
spawn();
time=60;
}
ui();
},1000);

/////////////////////
// GAME LOOP
/////////////////////
function loop(){
move();
chase();
draw();

if(Math.random()<0.01) randomQuiz();

if(lives<=0){
saveHigh(score);
panel.innerHTML="<h2>üíÄ Game Over</h2>";
return;
}

requestAnimationFrame(loop);
}

spawn();
ui();
loop();
</script>
</body>
</html>

